#!/bin/bash

echo "=========================="
echo "U-20 (상)"
echo "점검 사항 : finger 서비스 활성화 여부 점검"
echo "=========================="

# 점검 결과 변수 초기화
result="양호"
reason="익명 FTP 접속이 비활성화되어 있습니다."

# /etc/passwd 파일에서 ftp 또는 anonymous 계정 확인
if grep -E '^ftp|^anonymous' /etc/passwd; then
    result="취약"
    reason="/etc/passwd 파일에 익명 FTP 접속을 위한 계정이 존재합니다."
fi

# vsftpd 설정 파일에서 anonymous_enable 옵션 확인
if [ -f "/etc/vsftpd.conf" ]; then
    if grep -q "^anonymous_enable=YES" /etc/vsftpd.conf; then
        result="취약"
        reason="/etc/vsftpd.conf 파일에서 익명 FTP 접속이 허용되어 있습니다."
    fi
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"
