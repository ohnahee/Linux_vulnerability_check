#!/bin/bash

echo "=========================="
echo "U-34 (상)"
echo "점검 사항: Secondary Name Server로만 Zone 정보 전송 제한 여부 점검"
echo "=========================="

# 점검 결과 변수 초기화
result="양호"
reason="Zone Transfer가 특정 Secondary Name Server로만 제한되어 있습니다."

# BIND 설정 파일 경로
bind_config="/etc/bind/named.conf"

# Zone Transfer 설정 확인
if grep -qi "allow-transfer" "$bind_config"; then
    echo "allow-transfer 설정이 존재합니다."
else
    result="취약"
    reason="allow-transfer 설정이 없습니다. 모든 사용자에게 Zone Transfer가 허용될 수 있습니다."
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"
