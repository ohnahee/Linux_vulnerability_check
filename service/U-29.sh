#!/bin/bash

echo "=========================="
echo "U-29 (상)"
echo "점검 사항:  tftp, talk, ntalk 서비스가 활성화 점검"
echo "=========================="

# 점검 결과 변수 초기화
result="양호"
reason="모든 점검 대상 서비스가 비활성화되어 있습니다."

# 점검할 서비스 목록
services=("tftpd-hpa" "inetd")

# tftp 서비스 점검
if systemctl is-active --quiet tftpd-hpa; then
  result="취약"
  reason="tftpd-hpa (tftp) 서비스가 활성화되어 있습니다."
fi

# talk 및 ntalk 서비스 점검 (inetd를 통해 제공되므로 동일하게 확인)
if systemctl is-active --quiet inetd; then
  if dpkg -l | grep -q "talk"; then
    result="취약"
    reason="talk 서비스가 활성화되어 있습니다."
  elif dpkg -l | grep -q "ntalk"; then
    result="취약"
    reason="ntalk 서비스가 활성화되어 있습니다."
  fi
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"
