#!/bin/bash

echo "=========================="
echo "U-25 (상)"
echo "점검 사항: NFS 접근 제한 설정 적용 여부 점검"
echo "=========================="

# 점검 결과 변수 초기화
result="양호"
reason="NFS 서비스가 비활성화되어 있거나 접근 제한 설정이 적절합니다."

# NFS 서비스 상태 확인
nfs_status=$(sudo systemctl is-active nfs-server)
if [ "$nfs_status" == "active" ]; then
    # /etc/exports 파일 점검
    exports_content=$(cat /etc/exports)
    if echo "$exports_content" | grep -qE '\*\(rw|\*\(ro'; then
        result="취약"
        reason="/etc/exports 파일에서 everyone 접근을 허용하는 설정이 발견되었습니다."
    fi
else
    reason="NFS 서비스가 비활성화되어 있습니다."
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"
