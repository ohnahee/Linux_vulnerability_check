#!/bin/bash

echo "=========================="
echo "U-31 (상)"
echo "점검 사항: SMTP 서버의 릴레이 기능 제한 여부 점검"
echo "=========================="

# 점검 결과 변수 초기화
result="양호"
reason="SMTP 릴레이 제한이 설정되어 있습니다."

# Postfix 설정 파일 경로
postfix_config="/etc/postfix/main.cf"

# 릴레이 제한 설정 확인
if grep -q 'smtpd_recipient_restrictions.*reject_unauth_destination' "$postfix_config"; then
  result="양호"
  reason="SMTP 릴레이 제한이 설정되어 있습니다."
else
  result="취약"
  reason="SMTP 릴레이 제한이 설정되어 있지 않습니다."
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"
