#!/bin/bash

echo "=========================="
echo "U-32 (상)"
echo "점검 사항: SMTP 서비스 일반 사용자의 q 옵션 제한 여부 점검"
echo "=========================="

# 점검 결과 변수 초기화
result="양호"
reason="restrictqrun 옵션이 sendmail.cf 파일에 설정되어 있습니다."

# Sendmail 설정 파일 경로
sendmail_config="/etc/mail/sendmail.cf"

# restrictqrun 옵션 확인
if grep -qi "^O restrictqrun" "$sendmail_config"; then
  result="양호"
  reason="restrictqrun 옵션이 sendmail.cf 파일에 설정되어 있습니다."
else
  result="취약"
  reason="restrictqrun 옵션이 sendmail.cf 파일에 설정되어 있지 않습니다."
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"
