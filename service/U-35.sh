#!/bin/bash

echo "=========================="
echo "U-35 (상)"
echo "점검 사항: 디렉터리 검색 기능의 활성화 여부 점검"
echo "=========================="

# 점검 결과 변수 초기화
result="양호"
reason="디렉터리 검색 기능이 비활성화되어 있습니다."

# Apache 설정 파일 경로
apache_config_files=("/etc/apache2/apache2.conf" "/etc/apache2/conf-available/*.conf" "/etc/apache2/sites-available/*.conf")

# 디렉터리 검색 기능 활성화 여부 점검
for config_file in "${apache_config_files[@]}"; do
    if grep -qi "Options Indexes" $config_file; then
        result="취약"
        reason="$config_file 파일에 Options Indexes 설정이 존재합니다."
        break
    fi
done

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"
