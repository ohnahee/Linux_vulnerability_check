#!/bin/bash

echo "=========================="
echo "U-47 (중)"
echo "점검 사항 : 패스워드 최대 사용 기간 설정 (90일 이하) 적용 여부 점검"
echo "=========================="

# /etc/login.defs 파일 점검
check_login_defs() {
    echo "/etc/login.defs 파일 점검"
    maxdays_login_defs=$(grep "^PASS_MAX_DAYS" /etc/login.defs | awk '{print $2}')
    if [ -z "$maxdays_login_defs" ]; then
        echo "취약: /etc/login.defs 파일에 PASS_MAX_DAYS 설정이 없습니다."
    elif [ "$maxdays_login_defs" -gt 90 ]; then
        echo "취약: /etc/login.defs 파일에 설정된 PASS_MAX_DAYS 값이 90일 초과입니다: $maxdays_login_defs"
    else
        echo "양호: /etc/login.defs 파일에 PASS_MAX_DAYS 설정이 90일 이하로 되어 있습니다: $maxdays_login_defs"
    fi
}

# 점검 실행
check_login_defs
