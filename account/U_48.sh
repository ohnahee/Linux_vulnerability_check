#!/bin/bash

echo "▶ U-48(중)◀"
echo " 취약 판단 기준 : 패스워드 최소 사용 기간이 설정되지 않았거나 1일 미만인 경우 취약하다고 판단"

# /etc/login.defs 파일에서 PASS_MIN_DAYS 설정 확인
pass_min_days=$(grep -E '^PASS_MIN_DAYS' /etc/login.defs | awk '{print $2}')

# 결과 판단
if [ -n "$pass_min_days" ]; then
    if [ "$pass_min_days" -ge 1 ]; then
        echo " /etc/login.defs 파일에서 패스워드 최소 사용 기간 설정: $pass_min_days 일"
        echo "※ U-48(중) : 양호(Good)"
    else
        echo " /etc/login.defs 파일에서 패스워드 최소 사용 기간 설정: $pass_min_days 일"
        echo "※ U-48(중) : 취약(Vulnerable)"
    fi
else
    echo "※ U-48(중) : 취약(Vulnerable)"
    echo " /etc/login.defs 파일에서 패스워드 최소 사용 기간 설정을 찾을 수 없습니다."
fi

exit 0
