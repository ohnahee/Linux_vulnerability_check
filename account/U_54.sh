#!/bin/bash

U_54() {
    echo ""
    echo "▶ U-54(하)◀"
    echo " 취약 판단 기준 : 세션 타임아웃(Session Timeout)이 600초(10분) 이하로 설정되어 있지 않은 경우"

    vulnerable=0

    # /etc/profile 파일 점검
    if [ -f /etc/profile ]; then
        if ! grep -q "TMOUT=600" /etc/profile && ! grep -q "TMOUT=300" /etc/profile; then
            vulnerable=1
        fi
    else
        vulnerable=1
    fi

    # /etc/csh.login 또는 /etc/csh.cshrc 파일 점검
    if [ -f /etc/csh.login ]; then
        if ! grep -q "set autologout=10" /etc/csh.login; then
            vulnerable=1
        fi
    elif [ -f /etc/csh.cshrc ]; then
        if ! grep -q "set autologout=10" /etc/csh.cshrc; then
            vulnerable=1
        fi
    else
        vulnerable=1
    fi

    if [ $vulnerable -eq 1 ]; then
        echo "※ U-54(하) 결과 : 취약(Vulnerable)"
        echo " 세션 타임아웃 설정이 600초(10분) 이하로 설정되어 있지 않습니다."
    else
        echo "※ U-54(하) 결과 : 양호(Good)"
    fi

    return 0
}

U_54
