#!/bin/bash

echo "▶ U_54(하) ◀"
echo "취약 판단 기준 : .profile 파일에 TMOUT 변수가 설정되어 있지 않거나, 600초 이하의 값으로 설정되지 않은 경우 취약하다고 판단"

# .profile 파일 경로
PROFILE_FILE="$HOME/.profile"

# .profile 파일이 존재하는지 확인
if [ ! -f "$PROFILE_FILE" ]; then
    echo "※ 결과 : 취약(Vulnerable)"
    echo " .profile 파일이 존재하지 않습니다."
    exit 1
fi

# .profile 파일에서 TMOUT 설정 확인
tmout_setting=$(grep "^export TMOUT=" "$PROFILE_FILE")

if [ -z "$tmout_setting" ]; then
    echo "※ 결과 : 취약(Vulnerable)"
    echo " .profile 파일에 TMOUT 변수가 설정되어 있지 않습니다."
else
    # TMOUT 값 추출
    tmout_value=$(echo "$tmout_setting" | cut -d'=' -f2)
    if [ "$tmout_value" -le 600 ]; then
        echo "※ 결과 : 양호(Good)"
        echo " .profile 파일에 TMOUT 변수가 설정되어 있습니다: $tmout_setting"
    else
        echo "※ 결과 : 취약(Vulnerable)"
        echo " .profile 파일에 설정된 TMOUT 값이 600초보다 큽니다: $tmout_value"
    fi
fi

exit 0
