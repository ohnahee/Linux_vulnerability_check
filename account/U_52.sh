#!/bin/bash

echo "▶ U-52(중)◀"
echo " 취약 판단 기준 : 동일한 UID를 가진 사용자가 있는 경우 취약하다고 판단"

# 동일한 UID를 가진 사용자 확인
duplicate_uids=$(awk -F: '{print $3}' /etc/passwd | sort | uniq -d)

if [ -n "$duplicate_uids" ]; then
    echo " 동일한 UID를 가진 사용자들이 존재합니다:"
    for uid in $duplicate_uids; do
        users=$(awk -F: -v uid="$uid" '$3 == uid {print $1}' /etc/passwd | xargs)
        echo " UID $uid: $users"
    done
    echo "※ U-52(중) : 취약(Vulnerable)"
else
    echo " 동일한 UID를 가진 사용자가 존재하지 않습니다."
    echo "※ U-52(중) : 양호(Good)"
fi

exit 0
