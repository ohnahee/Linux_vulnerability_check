#!/bin/bash

echo "▶ U-46(중)◀"
echo " 취약 판단 기준 : 비밀번호 최소 길이 설정이 없는 경우 또는 8자 미만인 경우 취약하다고 판단"

# /etc/security/pwquality.conf 파일에서 minlen 설정 확인
pwquality_min_len=$(grep -E '^\s*minlen\s*=\s*[0-9]+' /etc/security/pwquality.conf | awk -F= '{print $2}' | xargs)

# 결과 판단
if [ -n "$pwquality_min_len" ] && [ "$pwquality_min_len" -ge 8 ]; then
    echo " /etc/security/pwquality.conf 파일에서 비밀번호 최소 길이 설정: $pwquality_min_len"
    echo "※ U-46(중) : 양호(Good)"
else
    echo "※ U-46(중) : 취약(Vulnerable)"
    if [ -z "$pwquality_min_len" ]; then
        echo " /etc/security/pwquality.conf 파일에서 비밀번호 최소 길이 설정을 찾을 수 없습니다."
    else
        echo " /etc/security/pwquality.conf 파일에서 설정된 비밀번호 최소 길이: $pwquality_min_len"
    fi
fi

exit 0
