#!/bin/bash

echo "=========================="
echo "U-48 (중)"
echo "점검 사항 : 패스워드 최소 사용 기간 설정 (1일 이상) 적용 여부 점검"
echo "=========================="

# /etc/login.defs 파일 점검
check_login_defs() {
    echo "점검: /etc/login.defs 파일"
    mindays_login_defs=$(grep "^PASS_MIN_DAYS" /etc/login.defs | awk '{print $2}')
    if [ -z "$mindays_login_defs" ]; then
        echo "취약: /etc/login.defs 파일에 PASS_MIN_DAYS 설정이 없습니다."
    elif [ "$mindays_login_defs" -lt 1 ]; then
        echo "취약: /etc/login.defs 파일에 설정된 PASS_MIN_DAYS 값이 최소 사용 기간에 부합하지 않습니다: $mindays_login_defs"
    else
        echo "양호: /etc/login.defs 파일에 PASS_MIN_DAYS 설정이 최소 사용 기간에 부합합니다: $mindays_login_defs"
    fi
}

# 점검 실행
check_login_defs
