#!/bin/bash

U_51() {
    echo ""
    echo "▶ U-51(하)◀"
    echo " 취약 판단 기준 : 시스템 관리나 운용에 불필요한 그룹이 있는 경우"
    echo " 불필요한 그룹 = 그룹에 계정이 존재하지 않는 그룹"

    unnecessary_groups=($(grep -vE '^#|^\s#' /etc/group | awk -F : '$3>=500 && $4=="" {print $1}'))

    for group in "${unnecessary_groups[@]}"; do
        if [ $(grep -E "^$group:" /etc/passwd | wc -l) -eq 0 ]; then
            echo "※ U-51(하) 결과 : 취약(Vulnerable)"
            echo " 불필요한 그룹이 존재합니다: $group"
            return 0
        fi
    done

    echo "※ U-51(하) 결과 : 양호(Good)"
    return 0
}



U_51