#!/bin/bash

# 우분투 시스템에 대한 U-44 취약점 진단 스크립트: UID 0인 사용자의 존재 여부 확인

echo "▶ U-44(중)◀"
echo " 취약 판단 기준 : root 계정과 동일한 UID를 가진 사용자가 존재하는 경우 취약하다고 판단"

# /etc/passwd 파일에서 UID 0인 사용자 목록 확인
uid_0_users=$(awk -F: '$3 == 0 {print $1}' /etc/passwd)

# UID 0인 사용자가 root 외에 존재하는지 확인
if [ $(echo "$uid_0_users" | wc -l) -gt 1 ]; then
    echo "※ U-44(중) 결과 : 취약(Vulnerable)"
    echo " 다음 사용자가 root와 동일한 UID(0)를 가지고 있습니다: $(echo $uid_0_users | grep -v 'root')"
else
    echo "※ U-44(중) 결과 : 양호(Good)"
    echo " root 외에 UID 0인 사용자가 존재하지 않습니다."
fi

exit 0
