#!/bin/bash

echo "=========================="
echo "U-05 (상)"
echo "점검 사항 : root(UID=0) 계정과 동일한 UID를 가진 계정 존재 여부 점검"
echo "=========================="

# /etc/passwd 파일에서 UID=0인 계정 찾기
duplicate_uid_check=$(awk -F: '($3 == 0) {print $1}' /etc/passwd)

if [ $(echo "$duplicate_uid_check" | wc -l) -gt 1 ]; then
    echo "취약: 다음 계정들이 root(UID=0) 계정과 동일한 UID를 가지고 있습니다:"
    echo "$duplicate_uid_check"
else
    echo "양호: root(UID=0) 계정과 동일한 UID를 가진 계정이 존재하지 않습니다."
fi
