#!/bin/bash

echo "=========================="
echo "U-54 (하)"
echo "점검 사항 : Session Timeout 설정 여부 및 값 점검 (/etc/profile)"
echo "=========================="

# 점검할 파일
file="/etc/profile"

# 파일이 존재하는지 확인
if [ -f $file ]; then
    tmout_value=$(grep -i 'TMOUT' $file | awk -F= '{print $2}')
    
    if [ -z "$tmout_value" ]; then
        echo "취약: $file 파일에 TMOUT 설정이 없습니다."
    elif [ "$tmout_value" -gt 600 ]; then
        echo "취약: $file 파일에 설정된 TMOUT 값이 600초(10분) 초과입니다: $tmout_value"
    else
        echo "양호: $file 파일에 설정된 TMOUT 값이 600초(10분) 이하입니다: $tmout_value"
    fi
else
    echo "경고: $file 파일이 존재하지 않습니다."
fi

echo
echo "조치 방법: /etc/profile 파일에 TMOUT=600 이하로 설정하십시오. 예: export TMOUT=600"
