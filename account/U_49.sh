#!/bin/bash

echo "▶ U-49(하)◀"
echo " 취약 판단 기준 : 불필요한 계정이 존재하는 경우"

# 불필요한 계정 목록
UNNECESSARY_ACCOUNTS="daemon|bin|sys|adm|listen|nobody|nobody4|noaccess|diag|operator|gopher|games|ftp|apache|httpd|www-data|mysql|mariadb|postgres|mail|postfix|news|lp|uucp|nuucp"

# /etc/passwd 파일이 존재하는지 확인
if [ -f /etc/passwd ]; then
    # 불필요한 계정이 있는지 검사
    if [ $(awk -F : '{print $1}' /etc/passwd | grep -wE "$UNNECESSARY_ACCOUNTS" | wc -l) -gt 0 ]; then
        echo "※ U-49(하) 결과 : 취약(Vulnerable)"
        echo " 불필요한 계정이 존재합니다."
        exit 0
    fi
else
    echo "※ U-49(하) 결과 : 취약(Vulnerable)"
    echo " /etc/passwd 파일이 존재하지 않습니다."
    exit 0
fi

echo "※ U-49(하) 결과 : 양호(Good)"
exit 0
