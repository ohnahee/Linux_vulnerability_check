#!/bin/bash

echo "▶ U-47(중)◀"
echo " 취약 판단 기준 : 패스워드 최대 사용 기간이 설정되지 않았거나 90일 초과로 설정된 경우 취약하다고 판단"

# /etc/login.defs 파일에서 PASS_MAX_DAYS 설정 확인
pass_max_days=$(grep -E '^PASS_MAX_DAYS' /etc/login.defs | awk '{print $2}')

# 결과 판단
if [ -n "$pass_max_days" ]; then
    if [ "$pass_max_days" -le 90 ]; then
        echo " /etc/login.defs 파일에서 패스워드 최대 사용 기간 설정: $pass_max_days 일"
        echo "※ U-47(중) : 양호(Good)"
    else
        echo " /etc/login.defs 파일에서 패스워드 최대 사용 기간 설정: $pass_max_days 일"
        echo "※ U-47(중) : 취약(Vulnerable)"
    fi
else
    echo "※ U-47(중) : 취약(Vulnerable)"
    echo " /etc/login.defs 파일에서 패스워드 최대 사용 기간 설정을 찾을 수 없습니다."
fi

exit 0
