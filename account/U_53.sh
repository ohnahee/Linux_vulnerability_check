#!/bin/bash

U_53() {
    echo ""
    echo "▶ U-53(하)◀"
    echo " 취약 판단 기준 : 로그인이 필요하지 않은 계정에 /bin/false(/sbin/nologin) 쉘이 부여되어 있지 않은 경우"
    echo " 불필요한 계정에 대한 변경 필요 시 U_53 함수 수정 필요"
    echo " 불필요한 계정 = daemon, bin, sys, adm, listen, nobody, nobody4, noaccess, diag, operator, gopher, games, ftp, apache, httpd, www-data, mysql, mariadb, postgres, mail, postfix, news, lp, uucp, nuucp"

    if [ -f /etc/passwd ]; then
        # 불필요한 계정에 대한 쉘 설정을 점검
        if [ $(grep -E '^(daemon|bin|sys|adm|listen|nobody|nobody4|noaccess|diag|operator|gopher|games|ftp|apache|httpd|www-data|mysql|mariadb|postgres|mail|postfix|news|lp|uucp|nuucp):' /etc/passwd | awk -F : '$7!="/bin/false" && $7!="/sbin/nologin" {print}' | wc -l) -gt 0 ]; then
            echo "※ U-53 결과 : 취약(Vulnerable)"
            echo " 로그인이 필요하지 않은 불필요한 계정에 /bin/false 또는 /sbin/nologin 쉘이 부여되지 않았습니다."
            return 0
        fi
    else
        echo "※ U-53 결과 : 취약(Vulnerable)"
        echo " /etc/passwd 파일이 존재하지 않습니다."
        return 0
    fi

    echo "※ U-53 결과 : 양호(Good)"
    return 0
}

# U_53 함수를 호출하여 점검 작업을 실행
U_53
