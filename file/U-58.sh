#!/bin/bash

echo "=========================="
echo "U-58 (중)"
echo "점검 사항: 사용자 계정과 홈 디렉터리의 일치 여부를 점검"
echo "=========================="

# 결과 초기화
result="양호"
reason="모든 사용자 계정의 홈 디렉터리가 존재합니다."

# 사용자별 홈 디렉터리 점검
awk -F: '{ print $1, $6 }' /etc/passwd | while read user dir; do
    if [ ! -d "$dir" ]; then
        result="취약"
        reason="$user 계정의 홈 디렉터리가 존재하지 않습니다. (설정된 홈 디렉터리: $dir)"
        echo "$reason"
    else
        echo "$user 계정의 홈 디렉터리가 존재합니다. (홈 디렉터리: $dir)"
    fi
done

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"

exit 0
