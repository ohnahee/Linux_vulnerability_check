#!/bin/bash

echo "=========================="
echo "U-06 (상)"
echo "점검 사항: 시스템에 소유자가 존재하지 않는 파일이나 디렉터리 여부 점검"
echo "=========================="

# 점검 결과 변수 초기화
result="양호"
reason="시스템에 소유자가 존재하지 않는 파일이나 디렉터리가 없습니다."

# 소유자가 존재하지 않는 파일 및 디렉터리 찾기
orphans=$(sudo find / -nouser -o -nogroup 2>/dev/null)

# 소유자가 존재하지 않는 파일 및 디렉터리 진단
if [ -n "$orphans" ]; then
    result="취약"
    reason="시스템에 소유자가 존재하지 않는 파일이나 디렉터리가 있습니다."
else
    result="양호"
    reason="시스템에 소유자가 존재하지 않는 파일이나 디렉터리가 없습니다."
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"

if [ "$result" = "취약" ]; then
    echo "소유자가 존재하지 않는 파일 및 디렉터리 목록:"
    echo "$orphans"
fi

exit 0

