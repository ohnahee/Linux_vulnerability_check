#!/bin/bash

echo "▶ U-06(상)◀"
echo "취약 판단 기준 : 시스템에 소유자가 존재하지 않는 파일이나 디렉터리가 있으면 취약하다고 판단"

# 소유자가 존재하지 않는 파일 및 디렉터리 찾기
orphans=$(sudo find / -nouser -o -nogroup 2>/dev/null)

# 결과 초기화
vulnerable=false

# 소유자가 존재하지 않는 파일 및 디렉터리 진단
if [ -n "$orphans" ]; then
    echo "시스템에 소유자가 존재하지 않는 파일이나 디렉터리가 있습니다."
    vulnerable=true
else
    echo "시스템에 소유자가 존재하지 않는 파일이나 디렉터리가 없습니다."
    vulnerable=false
fi

# 최종 결과 출력
if [ "$vulnerable" = true ]; then
    echo "※ 결과 : 취약(Vulnerable)"
    echo " 시스템에 소유자가 존재하지 않는 파일이나 디렉터리가 있습니다."
    echo " 아래는 소유자가 존재하지 않는 파일 및 디렉터리 목록입니다:"
    echo "$orphans"
else
    echo "※ 결과 : 양호(Good)"
    echo " 시스템에 소유자가 존재하지 않는 파일이나 디렉터리가 없습니다."
fi

exit 0
