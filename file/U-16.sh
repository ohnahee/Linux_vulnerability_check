#!/bin/bash

echo "=========================="
echo "U-16 (상)"
echo "점검 사항: 존재하지 않는 device 파일 존재 여부 점검"
echo "=========================="

# 결과 초기화
result="양호"
reason="/dev 디렉터리에 존재하지 않는 device 파일이 존재하지 않습니다."

# /dev 디렉터리 내 존재하지 않는 device 파일 찾기
invalid_device_files=$(find /dev -type f ! -exec test -c {} \; -exec test -b {} \; -print 2>/dev/null)

# 존재하지 않는 device 파일이 있는 경우
if [ -n "$invalid_device_files" ]; then
    result="취약"
    reason="/dev 디렉터리에 존재하지 않는 device 파일이 존재합니다."
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"

# 존재하지 않는 device 파일 목록 출력
if [ "$result" = "취약" ]; then
    echo "존재하지 않는 device 파일 목록:"
    echo "$invalid_device_files"
fi

exit 0
