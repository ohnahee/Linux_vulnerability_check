#!/bin/bash

echo "▶ U-05(상)◀"
echo "취약 판단 기준 : PATH 환경 변수에 . (현재 디렉토리)가 포함되어 있으면 취약하다고 판단"

# PATH 환경 변수 확인
current_path=$(echo $PATH)

# . 포함 여부 확인
dot_in_path=$(echo $current_path | grep -E '(^\.|:\.:|:/\.)')

# 결과 초기화
vulnerable=false

# . 포함 여부 진단
if [ -n "$dot_in_path" ]; then
    echo "PATH 환경 변수에 현재 디렉토리 (.)가 포함되어 있습니다."
    vulnerable=true
else
    echo "PATH 환경 변수에 현재 디렉토리 (.)가 포함되어 있지 않습니다."
    vulnerable=false
fi

# 최종 결과 출력
if [ "$vulnerable" = true ]; then
    echo "※ 결과 : 취약(Vulnerable)"
    echo " PATH 환경 변수에 . (현재 디렉토리)가 포함되어 있습니다."
else
    echo "※ 결과 : 양호(Good)"
    echo " PATH 환경 변수에 . (현재 디렉토리)가 포함되어 있지 않습니다."
fi

exit 0
