#!/bin/bash

echo "=========================="
echo "U-15 (상)"
echo "점검 사항: 불필요한 world writable 파일 존재 여부 점검"
echo "=========================="

# 결과 초기화
result="양호"
reason="시스템 중요 파일에 world writable 파일이 존재하지 않습니다."

# 시스템 내 모든 world writable 파일 찾기
world_writable_files=$(find / -type f -perm -0002 2>/dev/null)

# world writable 파일이 있는 경우
if [ -n "$world_writable_files" ]; then
    result="취약"
    reason="시스템 내에 불필요한 world writable 파일이 존재합니다."
fi

# 점검 결과 출력
echo "=== 점검 결과: $result ==="
echo "이유: $reason"

# world writable 파일 목록 출력
if [ "$result" = "취약" ]; then
    echo "world writable 파일 목록:"
    echo "$world_writable_files"
fi

exit 0
