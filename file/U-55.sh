#!/bin/bash

echo "=========================="
echo "U-55 (하)"
echo "점검 사항: /etc/hosts.lpd 파일의 삭제 및 권한 적절성 점검"
echo "=========================="

# 파일 존재 여부 확인
if [ -e /etc/hosts.lpd ]; then
    echo "/etc/hosts.lpd 파일이 존재합니다."
    
    # 파일 소유자 및 권한 확인
    owner=$(stat -c %U /etc/hosts.lpd)
    permissions=$(stat -c %a /etc/hosts.lpd)
    
    echo "소유자: $owner"
    echo "권한: $permissions"
    
    # 소유자가 root가 아니거나 권한이 600이 아닌 경우
    if [ "$owner" != "root" ] || [ "$permissions" -ne 600 ]; then
        echo "조치가 필요합니다. /etc/hosts.lpd 파일의 소유자 또는 권한이 적절하지 않습니다."
        
        # 조치 방법
        echo "조치 방법: /etc/hosts.lpd 파일을 삭제하거나 파일 소유자를 root로 변경하고 권한을 600으로 설정하세요."
    else
        echo "소유자와 권한이 적절하게 설정되어 있습니다."
    fi
else
    echo "/etc/hosts.lpd 파일이 존재하지 않습니다."
fi

exit 0
